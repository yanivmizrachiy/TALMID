{% extends "base.html" %}
{% block content %}
  <a class="link text-white/70" href="/">← חזרה לבית</a>
  <h1 class="text-2xl md:text-3xl font-bold mt-2">חיפוש</h1>

  <form class="glass soft-shadow rounded-3xl p-5 mt-6" method="get" action="/חיפוש">
    <div class="flex flex-col md:flex-row gap-3 md:items-center">
      <input name="q" value="{{ q }}" placeholder="חיפוש לפי שם תלמיד, מורה, כיתה..." class="flex-1 px-4 py-3 rounded-2xl bg-white/5 border border-white/10" />
      <button class="px-5 py-3 rounded-2xl glass btn font-semibold">חפש</button>
    </div>
  </form>

  {% if q and q|length > 0 %}
    <section class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
      <div class="glass soft-shadow rounded-3xl p-6">
        <h2 class="text-lg font-semibold">תלמידים ({{ students|length }})</h2>
        <div class="mt-4 flex flex-col gap-2">
          {% for s in students %}
            <a class="glass btn rounded-2xl p-3 link" href="{{ url_student(s) }}">
              <div class="font-medium">{{ s.full_name }}</div>
              <div class="text-sm text-white/65">{% if s.grade %}שכבה {{ s.grade }}{% endif %}{% if s.homeroom_code %} • כיתה {{ s.homeroom_code }}{% endif %}</div>
            </a>
          {% endfor %}
          {% if students|length == 0 %}<div class="text-white/50">(אין תוצאות)</div>{% endif %}
        </div>
      </div>

      <div class="glass soft-shadow rounded-3xl p-6">
        <h2 class="text-lg font-semibold">מורים ({{ teachers|length }})</h2>
        <div class="mt-4 flex flex-col gap-2">
          {% for t in teachers %}
            <a class="glass btn rounded-2xl p-3 link" href="{{ url_teacher(t) }}">
              <div class="font-medium">{{ t.name }}</div>
              <div class="text-sm text-white/65">{{ t.group_count }} הקבצות • {{ t.student_count }} תלמידים</div>
            </a>
          {% endfor %}
          {% if teachers|length == 0 %}<div class="text-white/50">(אין תוצאות)</div>{% endif %}
        </div>
      </div>

      <div class="glass soft-shadow rounded-3xl p-6">
        <h2 class="text-lg font-semibold">כיתות אם ({{ homerooms|length }})</h2>
        <div class="mt-4 flex flex-wrap gap-2">
          {% for h in homerooms %}
            <a class="px-4 py-2 rounded-xl glass btn link" href="{{ url_homeroom(h.code) }}">
              {{ h.code }} <span class="text-white/60">({{ h.type }})</span>
            </a>
          {% endfor %}
          {% if homerooms|length == 0 %}<div class="text-white/50">(אין תוצאות)</div>{% endif %}
        </div>
      </div>

      <div class="glass soft-shadow rounded-3xl p-6">
        <h2 class="text-lg font-semibold">הקבצות ({{ groups|length }})</h2>
        <div class="mt-4 flex flex-col gap-2">
          {% for g in groups %}
            <a class="glass btn rounded-2xl p-3 link" href="{{ url_group(g) }}">
              <div class="font-medium">שכבת {{ g.grade }} – {{ g.subject }} – הקבצה {{ g.group_name }}{% if g.variant %} ({{ g.variant }}){% endif %}</div>
              <div class="text-sm text-white/65">{{ g.student_count }} תלמידים בהקבצה</div>
            </a>
          {% endfor %}
          {% if groups|length == 0 %}<div class="text-white/50">(אין תוצאות)</div>{% endif %}
        </div>
      </div>
    </section>
  {% endif %}
{% endblock %}
